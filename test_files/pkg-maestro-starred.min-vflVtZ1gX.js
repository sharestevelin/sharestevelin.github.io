define("modules/clean/api_v2/client",["require","exports","tslib","jquery","modules/clean/api_v2/error","modules/clean/devtools/perf_hub_actions","modules/constants/debug","modules/constants/request","modules/core/i18n","modules/core/cookies","modules/core/notify","modules/core/uri"],function(e,t,r,n,o,i,s,a,c,u,d,p){"use strict";var l=(function(){function e(e,t){if(void 0===e&&(e="async"),"async"===e){if(void 0!==t)throw new Error("syncMode is 'async'; do not specify a syncTimeout")}else{if("syncOrServiceWorker"===e)throw new Error("syncOrServiceWorker mode not yet supported");if(void 0===t)throw new Error("syncMode is "+e+", but syncTimeout was not specified");if(t<=0)throw new Error("syncMode is "+e+", and you passed syncTimeout="+t+". syncTimeout must be a positive number")}this.syncMode=e,this.syncTimeout=t}return e.prototype.rpc=function(t,r,n,o){null==n&&(n=null);var i=e.getHeaders(t,o),s=e.getRpcUriStringAndPath(r),a=JSON.stringify(n);return this.executeRpc(s.uriString,s.path,i,a)},e.prototype.upload=function(t,n,o,i,s){var a=e.getHeaders(t,r.__assign({"Dropbox-API-Arg":JSON.stringify(o)},s)),c=e.getRpcUriStringAndPath(n);return this.executeRpc(c.uriString,c.path,a,i,"application/octet-stream")},e.getHeaders=function(e,t){var n=u.read("__Host-js_csrf")||"";return r.__assign({"X-Dropbox-Uid":null!=e?e:a.LOGGED_OUT_X_DROPBOX_UID,"X-CSRF-Token":n},t)},e.getRpcUriStringAndPath=function(e){var t=new p({scheme:"https",authority:"www.dropbox.com",path:"/2/"+e});return s.CPROFILE_ENABLED&&t.setQuery({cProfile:s.CPROFILE_PARAMETER,parent_request_id:a.REQUEST_ID}),{uriString:t.toString(),path:t.getPath()}},e.prototype.executeRpc=function(e,t,r,n,o){switch(void 0===n&&(n=""),void 0===o&&(o="application/json"),this.syncMode){case"async":return this.executeAsyncRpc(e,t,r,n,o);case"sync":return this.executeSyncRpc(e,t,r,n,o);case"syncOrServiceWorker":throw new Error("syncOrServiceWorker mode not yet supported")}},e.prototype.executeAsyncRpc=function(t,r,o,i,s){return new Promise(function(a,c){return n.ajax({type:"POST",url:t,contentType:s,headers:o,data:i}).done(function(t,n,o){return a(e.processXHRSuccess(r,t,n,o))}).fail(function(t){return c(e.processXHRError(t))})})},e.prototype.executeSyncRpc=function(t,r,o,i,s){var a=Promise.resolve(null),c=function(t,n,o){a=Promise.resolve(e.processXHRSuccess(r,t,n,o))},u=function(t){a=Promise.reject(e.processXHRError(t))};return n.ajax({type:"POST",url:t,contentType:s,headers:o,data:i,async:!1,timeout:this.syncTimeout,success:c,error:u}),a},e.processXHRSuccess=function(e,t,r,n){return s.CPROFILE_ENABLED&&i.PerfHubActions.add_ajax_profile(n,e),null!=n.responseText?JSON.parse(n.responseText):null},e.processXHRError=function(e){return o.ApiError.parseResponse(e.status,e.getAllResponseHeaders(),e.responseText)},e})();t.ApiV2Client=l;var S=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.rpc=function(t,r,n,o,i){return void 0===i&&(i=!1),e.prototype.rpc.call(this,t,r,n,o).catch(function(e){var t;return t=null!=e.error?e.error.console_error:e.message?e.message:c._("There was a problem completing this request."),i&&d.error(t),Promise.reject(e)})},t})(l);t.TeamActionsClient=S}),function(){var e={}.hasOwnProperty,t=function(t,r){function n(){this.constructor=t}for(var o in r)e.call(r,o)&&(t[o]=r[o]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t};define("modules/clean/api_v2/error",["modules/core/html","modules/core/i18n"],function(r,n){var o,i,s,a,c,u,d,p;return d=n._,o=(function(){function t(){}return t.parseResponse=function(n,o,p,l){var S,f,_,y,g,m,T,h,A,L,v,E,R,O;null==l&&(l=null),null==l&&(l=(function(){switch(n){case 400:return a;case 401:return s;case 409:return i;case 429:return c;default:return n>=500?u:t}})()),A={raw:{status:n,headerString:o,responseBody:p}};try{y=JSON.parse(p)||{},A.error=y.error,A.summary=y.error_summary,h=(null!=(L=y.user_message)?L.text:void 0)||""}catch(e){e,A.error=null,A.summary=null,h=""}if(429===n&&(h=h||d('Folder updates in progress â€” please try again later. <a href="/help/9259">Learn more</a>')),h&&(h=new r(h)),A.headers={},null!=o)for(v=o.split("\n"),_=0,T=v.length;_<T;_++)S=v[_],S.length>0&&(E=S.split(": "),m=E[0],O=E[1],A.headers[m]=O);f=new l(h);for(g in A)e.call(A,g)&&(R=A[g],f[g]=R);return f},t})(),a=(function(e){function r(e){this.message=e}return t(r,e),r})(o),s=(function(e){function r(e){this.message=e}return t(r,e),r})(o),i=(function(e){function r(e){this.message=e}return t(r,e),r})(o),c=(function(e){function r(e){this.message=e}return t(r,e),r.prototype.getRetryAfter=function(){var e;return null!=(e=this.headers)?e["retry-after"]:void 0},r})(o),u=(function(e){function r(e){this.message=e}return t(r,e),r})(o),p=function(e){return function(t){if(t instanceof o)return e(t);throw t}},{catchApiError:p,ApiError:o,AppError:i,AuthError:s,BadRequestError:a,RateLimitError:c,ServerError:u}})}.call(this),define("modules/clean/react/home/api",["require","exports","tslib","modules/clean/ajax","modules/clean/api_v2/client"],function(e,t,r,n,o){"use strict";var i=Promise.resolve({});t.makeRequest=function(e,t){void 0===t&&(t={});var o,s=function(o,i){(t.isBackground?n.SilentBackgroundRequest:n.WebRequest)(r.__assign({dataType:"json",success:o,error:function(e,t,r){return i(Error(r))}},e))};return t.useQueue?(o=new Promise(function(e,t){i.finally(function(){s(e,t)})}),i=o):o=new Promise(function(e,t){s(e,t)}),o},t.logHomeActivity=function(e){var r=e.entryType,n=e.eventName,o=e.extra,i=e.role;return Object.keys(o).forEach(function(e){return o[e]=String(o[e])}),t.makeRequest({url:"/home_feed/log_activity",type:"POST",data:{entry_type:r,event_name:n,extra:JSON.stringify(o),role:i}},{isBackground:!0})},t.setSectionVisibility=function(e,t,r){return(new o.ApiV2Client).rpc(e,"home/set_section_visibility",{section:t,visible:r})},t.createPaperDoc=function(e){return(new o.ApiV2Client).upload(e,"paper/docs/create",{import_format:"plain_text"},"")}}),define("modules/clean/react/home/starred/constants",["require","exports"],function(e,t){"use strict";t.StarredResourceActionTypes={LOADING_INITIAL:"HOME_STARRED_LOADING_INITIAL",LOADING_ALL:"HOME_STARRED_LOADING_ALL",LOAD_SUCCESS:"HOME_STARRED_LOAD_SUCCESS",LOAD_FAILURE:"HOME_STARRED_LOAD_FAILURE",HIDE_EMPTY_SECTION:"HOME_STARRED_HIDE_EMPTY_SECTION"},t.NOT_PAPER_USER_ERROR="not_paper_user",t.NUM_ACTIVITIES_PER_ITEM=5,t.StarredLoggingTypes={CLICK_STAR:"click_star",CLICK_UNSTAR:"click_unstar"}}),define("modules/clean/react/starred/actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/starred/constants","modules/clean/react/starred/api","modules/clean/react/starred/model"],function(e,t,r,n,o,i){"use strict";var s=(function(){function e(){}return e.fetchStatuses=function(e,t){return r.dispatch({type:n.StarredActionTypes.LOADING,idTypePairs:t}),o.fetchStatuses(e,t).then(function(e){r.dispatch({type:n.StarredActionTypes.SET_STATUS,starredStatuses:i.statusResultsToStarredStatuses(e)})}).catch(function(e){return r.dispatch({type:n.StarredActionTypes.LOAD_FAILURE,idTypePairs:t}),Promise.reject(e)})},e.update=function(e,t,i,s){var a={id:t,type:i};r.dispatch({type:n.StarredActionTypes.LOADING,idTypePairs:[a]});var c,u=o.update(e,t,i,s);return u.then(function(){return c=s}).catch(function(e){throw c=!s,e}).finally(function(){r.dispatch({type:n.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:{id:t,type:i},starred:c}]})}),u},e})();t.StarredActions=s}),define("modules/clean/react/starred/api",["require","exports","modules/clean/ajax"],function(e,t,r){"use strict";var n=function(e,t){var n=function(n,o){r.WebRequest({url:e,type:"POST",dataType:"json",data:t,success:n,error:function(e,t,r){return o(Error(r))}})};return new Promise(function(e,t){n(e,t)})};t.fetchStatuses=function(e,t){return n("/starred/get_status",{role:e,resources_json:JSON.stringify(t)})},t.update=function(e,t,r,o){return n("/starred/update",{role:e,resource_id:t,id_type:r,is_starred:o})}}),define("modules/clean/react/starred/constants",["require","exports"],function(e,t){"use strict";t.StarredLoadingState={LOADING:"LOADING",LOAD_SUCCESS:"LOAD_SUCCESS",LOAD_FAILED:"LOAD_FAILED"},t.StarredActionTypes={LOADING:"STARRED_LOADING",SET_STATUS:"STARRED_SET_STATUS",LOAD_FAILURE:"STARRED_LOAD_FAILURE"},t.IdTypes={ENCODED_FILE_OBJ_ID:"ENCODED_FILE_OBJ_ID",PAPER_ID_PATH:"PAPER_ID_PATH"}}),define("modules/clean/react/starred/id_type_pair",["require","exports"],function(e,t){"use strict";function r(e){return e.type+":"+e.id}function n(e){return e.slice(e.indexOf(":")+1)}t.idTypePairToString=r,t.idFromIdTypePairString=n}),define("modules/clean/react/starred/model",["require","exports"],function(e,t){"use strict";function r(e){return e.map(function(e){var t=e.id,r=e.type,n=e.is_starred,o=e.canonical_id,i=e.canonical_id_type,s={idTypePair:{id:t,type:r},starred:n};return o&&i&&(s.canonicalIdTypePair={id:o,type:i}),s})}t.statusResultsToStarredStatuses=r}),define("modules/clean/react/starred/star",["require","exports","tslib","external/classnames","external/react","modules/clean/react/starred/starred_activity_logger","modules/clean/react/sprite","modules/clean/react/css","modules/clean/react/starred/actions","modules/clean/react/starred/store","modules/clean/react/title_bubble","modules/core/i18n","modules/core/notify"],function(e,t,r,n,o,i,s,a,c,u,d,p,l){"use strict";var S=(function(e){function t(t){var r=e.call(this,t)||this;return r.onStoreUpdate=function(){var e=r.getState();r.setState(e)},r.onClick=function(e){if(e.stopPropagation(),e.preventDefault(),r.props.overrides)return void r.props.overrides.onClick();if(!r.state.isLoading){var t=!r.state.isStarred;t?i.starredActivityLogger.logClickStar(r.props.id,r.props.idType,r.props.role):i.starredActivityLogger.logClickUnstar(r.props.id,r.props.idType,r.props.role),r.props.onStarClick&&r.props.onStarClick(t),c.StarredActions.update(r.props.role,r.props.id,r.props.idType,t).catch(function(e){var n;n=r.props.itemName?t?p._("There was a problem starring %(item_name)s").format({item_name:r.props.itemName}):p._("There was a problem unstarring %(item_name)s").format({item_name:r.props.itemName}):t?p._("There was a problem starring your selection"):p._("There was a problem unstarring your selection"),l.error(n)})}},r.state=r.getState(),r.removeStoreListener=u.StarredStore.addListener(r.onStoreUpdate),r.props.overrides&&(r.removeOverrideStoreListeners=r.props.overrides.getRemoveStoreListeners(r.onStoreUpdate)),r}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){this.removeStoreListener&&this.removeStoreListener(),this.removeOverrideStoreListeners&&this.removeOverrideStoreListeners()},t.prototype.getStateFromStore=function(){var e={id:this.props.id,type:this.props.idType};return{isLoading:u.StarredStore.getIsLoading(e),isStarred:u.StarredStore.getIsStarred(e)}},t.prototype.getState=function(){return this.props.overrides?this.props.overrides.getState():this.getStateFromStore()},t.prototype.getTooltipContent=function(){return this.state.isStarred?p._("Remove from Starred"):p._("Add to Starred")},t.prototype.render=function(){if(void 0===this.state.isStarred)return null;var e=this.state.isStarred||this.state.isLoading?"s_star":"s_unstar",t={star__toggle:!0,"star__toggle--starred":this.state.isStarred,"star__toggle--unstarred":!this.state.isStarred,"star__toggle--loading":this.state.isLoading,"u-pad-xs":!0};return o.createElement(d,{content:this.getTooltipContent(),position:this.props.tooltipPosition},o.createElement("button",{className:n(t),role:"button","aria-pressed":this.state.isStarred,"aria-label":"Star",onClick:this.onClick,onDoubleClick:this.onClick},o.createElement(s,{group:"web",name:e,alt:""})))},t})(o.PureComponent);S.displayName="Star",S.defaultProps={tooltipPosition:d.POSITIONS.TOP},t.Star=a(S,["/static/css/starred/star-vflEywxWh.css"])}),define("modules/clean/react/starred/starred_activity_logger",["require","exports","modules/clean/react/home/api","modules/clean/react/home/starred/constants"],function(e,t,r,n){"use strict";var o=(function(){function e(){}return e.prototype.logClickStar=function(e,t,o){return r.logHomeActivity({eventName:n.StarredLoggingTypes.CLICK_STAR,role:o,extra:{resource_id:e,id_type:t}})},e.prototype.logClickUnstar=function(e,t,o){return r.logHomeActivity({eventName:n.StarredLoggingTypes.CLICK_UNSTAR,role:o,extra:{resource_id:e,id_type:t}})},e})();t.StarredActivityLogger=o,t.starredActivityLogger=new o}),define("modules/clean/react/starred/store",["require","exports","tslib","external/underscore","modules/clean/flux/dispatcher","modules/clean/flux/flux_store","modules/clean/react/starred/constants","modules/clean/react/home/starred/constants","modules/clean/react/starred/id_type_pair"],function(e,t,r,n,o,i,s,a,c){"use strict";var u=(function(e){function t(){var t=e.call(this,o)||this;return t.idsToLoadingState={},t.idsToStarred={},t.pairStringToCanonicalString={},t}return r.__extends(t,e),t.prototype.getLoadingStates=function(){return this.idsToLoadingState},t.prototype.getCanonicalPairString=function(e){return this.pairStringToCanonicalString[c.idTypePairToString(e)]},t.prototype.hasIdTypePair=function(e){return this.idsToLoadingState.hasOwnProperty(c.idTypePairToString(e))},t.prototype.getLoadingState=function(e){var t=this.getCanonicalPairString(e)||c.idTypePairToString(e);return this.idsToLoadingState[t]},t.prototype.getIsStarred=function(e){return this.idsToStarred[this.getCanonicalPairString(e)]},t.prototype.getAllStarredPairStrings=function(){return n.keys(n.pick(this.idsToStarred,function(e){return e}))},t.prototype.getIsLoading=function(e){return this.getLoadingState(e)===s.StarredLoadingState.LOADING},t.prototype.onLoading=function(e){var t={};e.forEach(function(e){return t[c.idTypePairToString(e)]=s.StarredLoadingState.LOADING}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,t)},t.prototype.onSetStatus=function(e){var t=this;void 0===e&&(e=[]);var n={},o={};e.forEach(function(e){var i,a=c.idTypePairToString(e.idTypePair);i=e.canonicalIdTypePair?c.idTypePairToString(e.canonicalIdTypePair):t.pairStringToCanonicalString[a]||a,t.pairStringToCanonicalString=r.__assign((u={},u[a]=i,u[i]=i,u),t.pairStringToCanonicalString),n[i]=s.StarredLoadingState.LOAD_SUCCESS,o[i]=e.starred;var u}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,n),this.idsToStarred=r.__assign({},this.idsToStarred,o)},t.prototype.onLoadFailure=function(e){var t=this,n={};e.forEach(function(e){var r=c.idTypePairToString(e),o=t.idsToLoadingState[r];void 0!==o&&o!==s.StarredLoadingState.LOADING||(n[r]=s.StarredLoadingState.LOAD_FAILED)}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,n)},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case s.StarredActionTypes.LOADING:this.onLoading(t.idTypePairs);break;case s.StarredActionTypes.SET_STATUS:case a.StarredResourceActionTypes.LOAD_SUCCESS:this.onSetStatus(t.starredStatuses);break;case s.StarredActionTypes.LOAD_FAILURE:this.onLoadFailure(t.idTypePairs);break;default:return}this.__emitChange()},t})(i);t._StarredStoreClass=u,t.StarredStore=new u});
//# sourceMappingURL=pkg-maestro-starred.min.js-vflg0KUO4.map